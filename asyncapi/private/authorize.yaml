asyncapi: 3.0.0
info:
  title: WhiteBit Private API Authorization
  version: 1.0.0
  description: |
    Authorize WebSocket connection using authentication token.
    
    When you establish WS connection, you should authorize this ws connection via `authorize` method.
    After successful authorization you will be able to send requests for balances, [orders](/glossary#orders) etc.
    
    It only needs to be done successfully once.

servers:
  production:
    host: api.whitebit.com
    protocol: wss
    description: WhiteBIT Global Server
  eu:
    host: api.whitebit.eu
    protocol: wss
    description: WhiteBIT EU Server

channels:
  /ws:
    address: /ws
    description: Private API authorization channel
    messages:
      authorizeRequest:
        $ref: '#/components/messages/authorizeRequest'
      authorizeResponse:
        $ref: '#/components/messages/authorizeResponse'

operations:
  sendAuthorizeRequest:
    action: receive
    channel:
      $ref: '#/channels/~1ws'
    messages:
      - $ref: '#/channels/~1ws/messages/authorizeRequest'

  receiveAuthorizeResponse:
    action: send
    channel:
      $ref: '#/channels/~1ws'
    messages:
      - $ref: '#/channels/~1ws/messages/authorizeResponse'

components:
  messages:
    authorizeRequest:
      name: AuthorizeRequest
      title: Authorize Request
      summary: Authorize WebSocket connection with token
      payload:
        $ref: '#/components/schemas/AuthorizeRequest'
      examples:
        - name: authorizeRequest
          summary: |
            Authorize WebSocket connection with parameters:
            - params[0]: WebSocket token (get via /api/v4/profile/websocket_token)
            - params[1]: Constant string "public"
          payload:
            id: 0
            method: authorize
            params:
              - "<get_your_token_via_api>"
              - "public"

    authorizeResponse:
      name: AuthorizeResponse
      title: Authorize Response
      summary: Authorization confirmation
      payload:
        $ref: '#/components/schemas/AuthorizeResponse'
      examples:
        - name: authorizeSuccess
          summary: Authorization successful
          payload:
            id: 0
            result:
              status: success
            error: null

  schemas:
    AuthorizeRequest:
      type: object
      required:
        - id
        - method
        - params
      properties:
        id:
          type: integer
          description: Unique request identifier
        method:
          const: authorize
          description: Method name for authorization
        params:
          type: array
          minItems: 2
          maxItems: 2
          items:
            - type: string
              description: WebSocket Token (get via `/api/v4/profile/websocket_token` endpoint)
            - type: string
              enum: ["public"]
              description: Constant string, always should be "public"
          description: Array with WebSocket token and constant "public" string

    AuthorizeResponse:
      type: object
      required:
        - id
        - result
        - error
      properties:
        id:
          type: integer
          description: Request identifier matching the request
        result:
          type: object
          required:
            - status
          properties:
            status:
              type: string
              enum: [success]
              description: Authorization status
        error:
          type: "null"
          description: Error object (null on success)